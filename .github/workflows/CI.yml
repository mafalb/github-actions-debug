# vim: set ft=yaml ts=2 expandtab:
---

name: runner debug

on: 

  push:
  pull_request:
  workflow_dispatch:

jobs:

  build:

    runs-on: ubuntu-22.04

    steps:
         
      - name: checkout collection ansible
        uses: actions/checkout@v4
        with:
          path: src
    
      - name: checkout collection ansible
        uses: actions/checkout@v4
           
      - name: debug environment 2
        run: |
           pwd
           echo $HOME
           whoami
           echo github_workflow $GITHUB_WORKSPACE
           tree $HOME/work

      - name: python
        run: |
          echo $PATH
          which python
          ls -l /opt/hostedtoolcache/Python/
        
      - name: docker version
        run: |
          docker --version
          dockerd --version

      - name: list local docker images
        run: docker images
        
      - name: check if podman is available
        run: podman --version
        
      - name: /etc/docker
        run: ls -l /etc/docker

      - name: get kernel config
        run: cat /boot/config-$(uname -r)

      - name: get mounted filesystems
        run: df -h

      - name: get all installed packages
        run: dpkg -l

      - name: get all installed python packages
        run: pip list
        
      - name: get info about ansible
        run: ansible --version
      
      - name: get info about ansible-playbook
        run: ansible-playbook --version
      
      - name: get info about galaxy
        run: ansible-galaxy --version

      - name: get ansible facts
        run: ansible localhost -m setup
        
      - name: ls
        run: |
          pwd
          ls -l
        
      - name: install venv requirements
        run: |
          sudo apt-get update
          sudo apt-get install python3-venv

      - name: get environment
        run: env

      - name: set path
        run: export PATH=/home/runner/.local/bin:$PATH

      - name: get environment
        run: env
      
      - name: Network setup
        run: |
          ip addr li
          ip ro li
          sudo iptables -L -v
          sudo iptables -L -v -t nat
          docker network ls
          docker network inspect bridge
...
